<!DOCTYPE html>
{% load static i18n %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}" class="dark">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block head_title %}{% endblock %}</title>
  <link
    href="{% static 'css/styles.css' %}"
    rel="stylesheet"
    type="text/css"
    nonce="{{ request.csp_nonce }}"
  >
</head>
<body class="min-h-screen flex flex-col">

<header class="bg-gray-800 text-white">
  <nav class="container mx-auto px-4 py-3 flex items-center justify-between">

    <a href="/" class="text-2xl font-semibold">
      {{ SITE_NAME }}
    </a>

    <details class="md:hidden">
      <summary class="cursor-pointer">
        <svg
          class="w-6 h-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16">
          </path>
        </svg>
      </summary>
      <div class="mt-2 space-y-2">
        <a
          href="/"
          class="flex items-center text-primary-600 dark:text-primary-500 text-sm font-medium"
        >
          {% trans "Return to site" %}
        </a>

        <form
          method="post"
          action="{% url 'set_language' %}"
          class="pt-2"
        >
          {% csrf_token %}
          {% get_available_languages as LANGUAGES %}
          <label
            for="language-dropdown-mobile"
            class="sr-only focus:not-sr-only"
          >{% trans "Select Language" %}</label>
          <select
            id="language-dropdown-mobile"
            name="language"
            onchange="this.form.submit()"
            class="block w-full bg-white dark:bg-gray-700
                     border border-gray-300 dark:border-gray-600
                     rounded p-2 focus:outline-none focus:ring
                     focus:ring-primary-200 dark:text-white"
            aria-label="{% trans 'Select Language' %}"
          >
            {% get_language_info_list for LANGUAGES as languages %}
            {% get_current_language as LANGUAGE_CODE %}
            {% for lang in languages %}
              <option
                lang="{{ lang.code }}"
                value="{{ lang.code }}"
                {% if lang.code == LANGUAGE_CODE %}selected{% endif %}
              >{{ lang.name_local }}</option>
            {% endfor %}
          </select>
        </form>

        {% if user.is_authenticated %}
          {% url 'account_email' as email_url_ %}
          {% url 'socialaccount_connections' as socialaccount_url_ %}
          {% if email_url_ or socialaccount_url_ %}
            <a
              href="{% if email_url_ %}{{ email_url_ }}{% else %}{{ socialaccount_url_ }}{% endif %}"
              class="block bg-gray-600 hover:bg-gray-700 text-white
                       py-2 px-4 rounded"
            >
              {% trans "Manage Account" %}
            </a>
          {% endif %}
          <a
            href="{% url 'account_logout' %}"
            class="block bg-red-600 hover:bg-red-700 text-white
                     py-2 px-4 rounded"
          >
            {% trans "Sign Out" %}
          </a>
        {% else %}
          <a
            href="{% url 'account_login' %}"
            class="block border border-white hover:bg-white hover:text-gray-800
                     text-white py-2 px-4 rounded"
          >
            {% trans "Sign In" %}
          </a>
          {% url 'account_signup' as signup_url_ %}
          {% if signup_url_ %}
            <a
              href="{{ signup_url_ }}"
              class="block bg-green-600 hover:bg-green-700 text-white
                       py-2 px-4 rounded"
            >
              {% trans "Sign Up" %}
            </a>
          {% endif %}
        {% endif %}
      </div>
    </details>

    <div class="hidden md:flex md:items-center md:space-x-6">

      <a
        href="/"
        class="flex items-center text-primary-600 dark:text-primary-500
                 text-sm font-medium"
      >
        {% trans "Return to site" %}
      </a>

      <form
        method="post"
        action="{% url 'set_language' %}"
        class="flex items-center space-x-2"
      >
        {% csrf_token %}
        {% get_available_languages as LANGUAGES %}
        <label for="language-dropdown" class="sr-only focus:not-sr-only">
          {% trans "Select Language" %}
        </label>
        <select
          id="language-dropdown"
          name="language"
          onchange="this.form.submit()"
          class="bg-white dark:bg-gray-700
                   border border-gray-300 dark:border-gray-600
                   rounded p-2 focus:outline-none focus:ring
                   focus:ring-primary-200 dark:text-white"
          aria-label="{% trans 'Select Language' %}"
        >
          {% get_language_info_list for LANGUAGES as languages %}
          {% get_current_language as LANGUAGE_CODE %}
          {% for lang in languages %}
            <option
              lang="{{ lang.code }}"
              value="{{ lang.code }}"
              {% if lang.code == LANGUAGE_CODE %}selected{% endif %}
            >{{ lang.name_local }}</option>
          {% endfor %}
        </select>
      </form>

      {% if user.is_authenticated %}
        <a
          href="{% if email_url_ %}{{ email_url_ }}{% else %}{{ socialaccount_url_ }}{% endif %}"
          class="bg-gray-600 hover:bg-gray-700 text-white
                   py-2 px-4 rounded"
        >
          {% trans "Manage Account" %}
        </a>
        <a
          href="{% url 'account_logout' %}"
          class="bg-red-600 hover:bg-red-700 text-white
                   py-2 px-4 rounded"
        >
          {% trans "Sign Out" %}
        </a>
      {% else %}
        <a
          href="{% url 'account_login' %}"
          class="border border-white hover:bg-white hover:text-gray-800
                   text-white py-2 px-4 rounded"
        >
          {% trans "Sign In" %}
        </a>
        {% if signup_url_ %}
          <a
            href="{{ signup_url_ }}"
            class="bg-green-600 hover:bg-green-700 text-white
                     py-2 px-4 rounded"
          >
            {% trans "Sign Up" %}
          </a>
        {% endif %}
      {% endif %}
    </div>

  </nav>
</header>

<main id="content" class="flex-grow">
  {% block body %}
    {% block content %}{% endblock content %}
  {% endblock body %}
</main>

{% block extra_body %}{% endblock extra_body %}
</body>
</html>
